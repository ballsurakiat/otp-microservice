# โครงสร้างของ OTP Microservice
โครงสร้างคร่าวๆ ของ Microservice พัฒนาด้วย python ต่อกับ sms provider vonage และ build docker ผ่าน port 3555

1. Endpoints (API)
ต้องการ 3 Endpoints:

  - POST /otp/send หรือ POST /otp/get

    - Input: เบอร์โทรศัพท์ของผู้ใช้ (phone_number)

    - Process:

      - สร้างรหัส OTP

      - จัดเก็บรหัส OTP พร้อมเบอร์โทรศัพท์และวันหมดอายุใน Cache

      - เรียกใช้ API ของ SMS Provider ที่คุณเลือก เพื่อส่งรหัส OTP ไปยังเบอร์โทรศัพท์ของผู้ใช้

      - ถ้าส่งสำเร็จ ให้คืนค่ากลับไปว่าส่งสำเร็จ

  - POST /otp/verify
    - Input: เบอร์โทรศัพท์ของผู้ใช้ (phone_number), รหัส OTP ที่ได้รับ (otp_code)

    - Process:

      - ดึงข้อมูล OTP ที่จัดเก็บไว้ใน Cache โดยใช้ phone_number เป็น Key

      - ตรวจสอบว่ารหัส OTP ที่ผู้ใช้ส่งมาตรงกับรหัสที่เก็บไว้หรือไม่

      - ตรวจสอบว่ารหัส OTP ยังไม่หมดอายุ

      - ถ้าข้อมูลถูกต้อง ให้ลบ OTP ออกจาก Cache และคืนค่าว่า Verify สำเร็จ

      - ถ้าไม่ถูกต้อง ให้คืนค่าว่า Verify ไม่สำเร็จ (เช่น "รหัสไม่ถูกต้อง" หรือ "รหัสหมดอายุแล้ว")

1. Error Handling & Security
- Rate Limiting: ป้องกันการส่ง OTP ถี่เกินไป เพื่อป้องกันการโจมตีหรือการใช้ทรัพยากรเกินจำเป็น

- Retry Logic: มีกลไกการลองส่งซ้ำ (Retry) หากการส่ง SMS ล้มเหลวชั่วคราว

- Logging: บันทึกการทำงานของระบบเพื่อใช้ในการตรวจสอบและแก้ไขปัญหา

- Input Validation: ตรวจสอบความถูกต้องของเบอร์โทรศัพท์ที่รับเข้ามา
